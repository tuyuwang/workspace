---
layout: default
title: 汇编
nav_order: 2
parent: 逆向
---

## 汇编指令

#### adrp

~~~
adrp x0. #1
add x0,x0,0xf28
~~~

这个adrp经常会和add指令同时出现.那么这种情况,一般是获取一个常量或者全局变量.

> adrp x0, 1

x0寄存器的值 = 0x1002e6000(当前PC寄存器的低12位清零) + 0x1000(1左移12位)。这个地址正好是PC当前的值.为什么低12位清零呢?因为内存是分页管理的,ARM64架构中.一页正好是4KB,也就是12根地址总线的寻址范围.

> add x0,x0,#0xf28

x0寄存器的值 = 0x1002e7000(刚才算出来的基值) + 0xf28(偏移地址)

[原文1](https://www.jianshu.com/p/ca967ceb700c)

#### bl

> bl xxx

将下一条指令的地址放入lr(x30)寄存器，然后转到标号处执行指令

#### ret

默认使用lr(x30)寄存器的值，通过底层指令提示CPU此处作为下条指令的地址

#### x30寄存器

x30寄存器存放的是函数的返回地址，当ret指令执行时刻，会寻找x30寄存器保存的地址值。在函数嵌套调用的时候，需要将x30入栈